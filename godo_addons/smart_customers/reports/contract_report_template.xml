<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="report_assets_common" name="Technical Service Assets Reports" inherit_id="web.report_assets_common">		
            <xpath expr="//link[last()]" position="after">			 	
                <link rel="stylesheet" href="smart_customers/static/src/css/report_styles.css"/>  
            </xpath>	
    </template>

    <template id="report_service_contract_document">
        <t t-call="web.external_layout">
            <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)" />


            <!-- 

        <t t-set="address">
            <div t-field="doc.partner_id"
                t-options='{"widget": "contact", "fields": ["address", "name"], "no_marker": True}' />
            <p t-if="doc.partner_id.vat"><t t-esc="doc.company_id.country_id.vat_label or 'Tax ID'"/>: <span t-field="doc.partner_id.vat"/></p>
        </t>
        <t t-if="doc.partner_shipping_id == doc.partner_invoice_id
                             and doc.partner_invoice_id != doc.partner_id
                             or doc.partner_shipping_id != doc.partner_invoice_id">
            <t t-set="information_block">
                <strong t-if="doc.partner_shipping_id == doc.partner_invoice_id">Invoicing and Shipping Address:</strong>
                <strong t-if="doc.partner_shipping_id != doc.partner_invoice_id">Invoicing Address:</strong>
                <div t-field="doc.partner_invoice_id"
                t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>
                <t t-if="doc.partner_shipping_id != doc.partner_invoice_id">
                    <strong>Shipping Address:</strong>
                    <div t-field="doc.partner_shipping_id"
                        t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>
                </t>
            </t>
        </t> --> 

            <div class="page">
                <div class="oe_structure" /> 
                <div class="row mt10">
                    <div class ="col-12 text-center">
                        <span> <b> CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</b></span> <br/>
                        Độc lập - Tự do - Hạnh phúc
                    </div>

                </div> 

                <h2 class="mt-5 text-center">
                    <!-- <t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
                    <span t-if="doc.state not in ['draft','sent']">Contract # </span>
                    <span t-if="doc.state in ['draft','sent']">Contract # </span>
                </t>  -->
                    <t>
                        <span> HỢP ĐỒNG SỬ DỤNG DỊCH VỤ </span>
                    </t>

                </h2>
                <div class="text-center"> 
                                Số hợp đồng: <b t-if="doc.contract_code"> <span t-field="doc.contract_code" /> </b> <br/> 
                                <b t-if="doc.contract_code == False" >
                                    <span t-field="doc.name" />  
                                </b> 
                                <br/>
                    Ngày: <span t-field="doc.date_order" t-options='{"format": "dd/MM/YYYY"}' />
                </div>


                

                <div class="row mt16 mt16" >

                    <div class="col-12" >
                        - Căn cứ Luật Thương Mại số 36/2005/QH11 của Nước Cộng hòa Xã hội Chủ nghĩa Việt Nam được Quốc hội thông qua ngày 14/06/2005. <br/>
                        - Căn cứ vào nhu cầu và khả năng của hai bên. <br/>
                        Hôm nay, ngày <span t-field="doc.date_order" t-options='{"format": "dd"}' />   tháng  <span t-field="doc.date_order" t-options='{"format": "MM"}' /> 
                        năm <span t-field="doc.date_order" t-options='{"format": "YYYY"}' />, 
                        tại Công ty <span t-field="doc.company_id.name"/>. Chúng tôi gồm có:

                    </div>
                </div>
                <div class="row mt16 mt16" >

                    <div class="col-12 pt-3" > 
                        <b>  BÊN A (Bên thuê dịch vụ): <t t-if="doc.partner_id.is_company == True"> <span t-field="doc.partner_id.company_name" />  </t> 
                        <t t-if="doc.partner_id.is_company == False"> <span t-field="doc.partner_id.name" /> </t> </b>
                            <br/>
                        -   Mã khách hàng: <span t-field="doc.partner_id.account.profile_code" /> <br/>
                        -	Địa chỉ:  <span t-field="doc.partner_id.street" />  <span t-field="doc.partner_id.ward.name" />,  <span t-field="doc.partner_id.district.name" />,  <span t-field="doc.partner_id.province.name" /> <br/>
                        -	Điện thoại:  <span t-field="doc.partner_id.mobile" /> <br/>
                        -	Mã số thuế/Giấy chứng nhận ĐKKD số : <span t-field="doc.partner_id.vat" />  <br/>
                        -	Số tài khoản   ..........		Tại ngân hàng:  <br/>
                        -	Đại diện:  <span t-field="doc.partner_id.name" />      <br/>       

                    </div>
                </div>
                <div class="row mt16 mt16" >

                    <div class="col-12 pt-3" > 
                        <b>  BÊN B (Bên thuê cung cấp dịch vụ):   <span t-field="doc.company_id.name" /> </b>
                            <br/> 
                        -	Địa chỉ:  <span t-field="doc.company_id.report_footer" /> <br/>
                        -	Điện thoại:  <span t-field="doc.company_id.partner_id.phone" /> <br/>
                        -	Mã số thuế/Giấy chứng nhận ĐKKD số : <span t-field="doc.company_id.partner_id.vat" />  <br/>
                        -	Số tài khoản   ..........		Tại ngân hàng:  <br/>
                        -	Đại diện:  <span t-field="doc.company_id.partner_id.name" />      <br/>       

                    </div>
                    
                    <!-- <div t-if="doc.client_order_ref" class="col-auto mw-100 mb-2">
                        <strong>Your Reference:</strong>
                        <p class="m-0" t-field="doc.client_order_ref" />
                    </div>
                    <div t-if="doc.date_order and doc.state not in ['draft','sent']" class="col-auto mw-100 mb-2">
                        <strong>Order Date:</strong>
                        <p class="m-0" t-field="doc.date_order" />
                    </div>
                    <div t-if="doc.date_order and doc.state in ['draft','sent']" class="col-auto mw-100 mb-2">
                        <strong>Quotation Date:</strong>
                        <p class="m-0" t-field="doc.date_order" t-options='{"widget": "date"}' />
                    </div>
                    <div t-if="doc.validity_date and doc.state in ['draft', 'sent']" class="col-auto mw-100 mb-2"
                        name="expiration_date">
                        <strong>Expiration:</strong>
                        <p class="m-0" t-field="doc.validity_date" />
                    </div>
                    <div t-if="doc.user_id.name" class="col-auto mw-100 mb-2">
                        <strong>Salesperson:</strong>
                        <p class="m-0" t-field="doc.user_id" />
                    </div> -->
                </div>

                <div class="row mt16 mt16" >
                    <div class="col-12">
                        (Sau đây Bên A và Bên B được gọi riêng là “Bên” và gọi chung là “Các Bên”) <br/>
                        Hai bên đồng ý xác lập và ký kết bản Hợp đồng này để thực hiện việc cung cấp và sử dụng hệ thống phần mềm của <span t-field="doc.company_id.name" /> (“Hợp đồng”) với các nội dung sau đây
                    </div> 
                </div>

                <div class="row mt16 mt16" >
                    <div class="col-12">
                    <b>ĐIỀU 1.  ĐỐI TƯỢNG CỦA HỢP ĐỒNG </b> <br/>
                        Bên B cung cấp một (01) Hệ thống phần mềm cho Bên A trên nền tảng Internet với thời hạn và các dịch vụ được nêu tại điều 4.1 của Hợp đồng này. <br/>
                    </div>
                </div>
                <div class="row mt16 mt16" >
                    <div class="col-12">
                    <b> ĐIỀU 2.	BẢO HÀNH VÀ HỖ TRỢ</b> <br/>
                        Nội dung bảo hành: Bên B có trách nhiệm bảo hành trong trường hợp Hệ thống quản lý khách hàng phát sinh lỗi trong thời gian hợp đồng có hiệu lực. <br/>
                    </div> 
                </div>

                <div class="row mt16 mt16" >
                    <div class="col-12">
                    <b>  ĐIỀU 3.    THỜI HẠN SỬ DỤNG DỊCH VỤ</b> <br/>

                            Thời gian bắt đầu sử dụng dịch vụ từ ngày <span t-field="doc.date_order" t-options='{"format": "dd/MM/YYYY"}' />  đến ngày <span t-field="doc.validity_date" t-options='{"format": "dd/MM/YYYY"}' />. <br/>
                    </div> 
                </div> 
                <div class="row mt16 mt16" >
                    <div class="col-12"> 
                    <b>    ĐIỀU 4.	PHÍ DỊCH VỤ VÀ PHƯƠNG THỨC THANH TOÁN </b> <br/>  
                        4.1.	Phí dịch vụ: <br/>  
                   
                    </div>
                </div> 

                <!-- Is there a discount on at least one line? -->
                <t t-set="display_discount" t-value="any([l.discount for l in doc.order_line])" /> 
          
                <table class="table table-sm o_main_table">
                    <thead>
                        <tr>
                            <th name="th_description" class="text-left">Dịch vụ</th>
                            <th name="th_quantity" class="text-right">Số lượng (ngày)</th>
                            <th name="th_priceunit" class="text-right">Đơn giá</th>
                            <th name="th_discount" t-if="display_discount" class="text-right"
                                groups="product.group_discount_per_so_line">
                                <span>Chiết khấu %</span>
                            </th>
                            <th name="th_taxes" class="text-right">Thuế</th>
                            <th name="th_subtotal" class="text-right">
                                <t groups="account.group_show_line_subtotals_tax_excluded">Cộng</t>
                                <t groups="account.group_show_line_subtotals_tax_included">Tổng tiền</t>
                            </th>
                        </tr>
                    </thead>
                    <tbody class="sale_tbody">

                        <t t-set="current_subtotal" t-value="0" />

                        <t t-foreach="doc.order_line" t-as="line">

                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal"
                                groups="account.group_show_line_subtotals_tax_excluded" />
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_total"
                                groups="account.group_show_line_subtotals_tax_included" />

                            <tr
                                t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                <t t-if="not line.display_type">
                                    <td name="td_name"><span t-field="line.name" /></td>
                                    <td name="td_quantity" class="text-right">
                                        <span t-field="line.product_uom_qty" />
                                        <span t-field="line.product_uom" groups="uom.group_uom" />
                                    </td>
                                    <td name="td_priceunit" class="text-right">
                                        <span t-field="line.price_unit" />
                                    </td>
                                    <td t-if="display_discount" class="text-right"
                                        groups="product.group_discount_per_so_line">
                                        <span t-field="line.discount" />
                                    </td>
                                    <td name="td_taxes" class="text-right">
                                        <span
                                            t-esc="', '.join(map(lambda x: (x.description or x.name), line.tax_id))" />
                                    </td>
                                    <td name="td_subtotal" class="text-right o_price_total">
                                        <span t-field="line.price_subtotal"
                                            groups="account.group_show_line_subtotals_tax_excluded" />
                                        <span t-field="line.price_total"
                                            groups="account.group_show_line_subtotals_tax_included" />
                                    </td>
                                </t>
                                <t t-if="line.display_type == 'line_section'">
                                    <td name="td_section_line" colspan="99">
                                        <span t-field="line.name" />
                                    </td>
                                    <t t-set="current_section" t-value="line" />
                                    <t t-set="current_subtotal" t-value="0" />
                                </t>
                                <t t-if="line.display_type == 'line_note'">
                                    <td name="td_note_line" colspan="99">
                                        <span t-field="line.name" />
                                    </td>
                                </t>
                            </tr>

                            <t
                                t-if="current_section and (line_last or doc.order_line[line_index+1].display_type == 'line_section')">
                                <tr class="is-subtotal text-right">
                                    <td name="td_section_subtotal" colspan="99">
                                        <strong class="mr16">Subtotal</strong>
                                        <span t-esc="current_subtotal"
                                            t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}' />
                                    </td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                </table>

                <div class="clearfix" name="so_total_summary">
                    <div id="total" class="row" name="total">
                        <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                            <table class="table table-sm">
                                <tr class="border-black o_subtotal" style="">
                                    <td name="td_amount_untaxed_label"><strong>Cộng</strong></td>
                                    <td name="td_amount_untaxed" class="text-right">
                                        <span t-field="doc.amount_untaxed" />
                                    </td>
                                </tr>
                                <t t-foreach="doc.amount_by_group" t-as="amount_by_group">
                                    <tr style="">
                                        <t t-if="amount_by_group[3] == 1 and doc.amount_untaxed == amount_by_group[2]">
                                            <td name="td_amount_by_group_label_3">
                                                <span t-esc="amount_by_group[0]" />
                                                <span>&amp;nbsp;<span>on</span>&amp;nbsp;
                                                    <t t-esc="amount_by_group[2]"
                                                        t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}' />
                                                    </span>
                                            </td>
                                            <td name="td_amount_by_group_3" class="text-right o_price_total">
                                                <span t-esc="amount_by_group[1]"
                                                    t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}' />
                                            </td>
                                        </t>
                                        <t t-else="">
                                            <td name="td_amount_by_group_label">
                                                <span t-esc="amount_by_group[0]" />
                                            </td>
                                            <td name="td_amount_by_group" class="text-right o_price_total">
                                                <span t-esc="amount_by_group[1]"
                                                    t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}' />
                                            </td>
                                        </t>
                                    </tr>
                                </t>
                                <tr class="border-black o_total">
                                    <td name="td_amount_total_label"><strong>Tổng tiền</strong></td>
                                    <td name="td_amount_total" class="text-right">
                                        <span t-field="doc.amount_total" />
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row mt16 mt16" >
                    <div class="col-12"> <p>
                        4.2.	Sau khi Bên B nhận được tất cả các phí dịch vụ liên quan đến Hợp đồng này và nhận được bản gốc hợp đồng, Bên B sẽ tiến hành xuất hoá đơn giá trị gia tăng cho Bên A. <br/> 
                        4.3.	Bên A có nghĩa vụ thanh toán 100% phí dịch vụ cho Bên B ngay sau khi ký kết Hợp đồng này. <br/> 
                        4.4.	Hình thức thanh toán: Chuyển khoản hoặc tiền mặt. <br/> 
                        Trong trường hợp Bên A thanh toán bằng hình thức chuyển khoản, khoản phí tại Điều 4.1 sẽ được thanh toán tại tài khoản của Bên B ghi tại phần đầu của Hợp đồng này. <br/>
                        </p>
                    </div>
                </div> 

                 <div class="row mt16 mt16" >
                    <div class="col-12">
                        <p> 
                      <b>  ĐIỀU 5.	ĐIỀU KHOẢN KHÁC </b> <br/> 
                        5.1	Trong trường hợp một Bên muốn sửa đổi các điều khoản trong Hợp đồng thì phải thông báo cho Bên kia biết trước ít nhất là ba (03) ngày bằng văn bản và cùng nhau thoả thuận lại những điểm cần thay đổi với sự đồng ý của hai Bên bằng văn bản. Sau khi đã thảo luận và thống nhất, nếu xét thấy cần thiết, các Bên sẽ ký các phụ lục bổ sung cho Hợp đồng này.   <br/>
                        5.2	Các Phụ lục và Các điều kiện và điều khoản chung của Hợp đồng này là một phần không thể tách rời của Hợp đồng này. <br/>
                        5.3	Hợp đồng này được lập thành hai (02) bản có giá trị pháp lý như nhau, mỗi bên giữ một (01) bản./. <br/>
                        </p>
                    </div> 
                </div>

                <div class="row mt32 " >
                    <div class="col-6  text-center">
                        <b>BÊN A</b> <br/>
                        <i> Ký, đóng dấu </i>
                       
                    </div> 

                    <div class="col-6  text-center">
                            <b>BÊN B</b>  <br/>
                       <i> Ký, đóng dấu </i>
                    </div> 
                </div>

                  <div class="row mt64 " >
                    <div class="col-6  text-center"> 
                       <span   t-field="doc.partner_id.name">  </span>
                       
                    </div> 

                    <div class="col-6  text-center"> 
                            <span  t-field="doc.company_id.company_registry">  </span>
                       
                    </div> 
                </div>

                




                <div t-if="doc.signature" class="mt32 ml64 mr4" name="signature">
                    <div class="offset-8">
                        <strong>Signature</strong>
                    </div>
                    <div class="offset-8">
                        <img t-att-src="image_data_uri(doc.signature)" style="max-height: 4cm; max-width: 8cm;" />
                    </div>
                    <div class="offset-8 text-center">
                        <p t-field="doc.signed_by" />
                    </div>
                </div>

                <div class="oe_structure" />

                <p t-field="doc.note" />
                <p t-if="doc.payment_term_id.note">
                    <span t-field="doc.payment_term_id.note" />
                </p>
                <p id="fiscal_position_remark" t-if="doc.fiscal_position_id and doc.fiscal_position_id.sudo().note">
                    <strong>Fiscal Position Remark:</strong>
                    <span t-field="doc.fiscal_position_id.sudo().note" />
                </p>
            </div>
        </t>
    </template>


    <template id="report_service_contract">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="smart_customers.report_service_contract_document" t-lang="doc.partner_id.lang" />
            </t>
        </t>
    </template>



</odoo>